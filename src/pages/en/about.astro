---
import Layout from "../../layouts/Layout.astro";
import ContactCTA from "../../components/ContactCTA.astro";
import { useTranslations, getSkillCategories, getJobs } from '../../lib/i18n/utils';
import type { Lang } from '../../lib/i18n/utils';

const lang: Lang = 'en';
const t = useTranslations(lang);
const skillCategories = getSkillCategories(t);
const jobs = getJobs(t);
---

<Layout
  title={t('meta.title')}
  page="page-about"
  description={t('meta.description')}
>
  <!-- Schema.org WorkExperience -->
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "Person",
    "name": "JJMontalban",
    "jobTitle": t('meta.jobTitle'),
    "url": "https://jjmontalban.com/en/about",
    "sameAs": [
      "https://github.com/jjmontalban",
      "https://www.linkedin.com/in/jjmontalban/",
      "https://profiles.wordpress.org/jjmontalban/"
    ],
    "knowsAbout": skillCategories.flatMap(cat => cat.items),
    "hasOccupation": jobs.map(job => ({
      "@type": "Occupation",
      "name": job.position,
      "occupationLocation": {
        "@type": "Country",
        "name": "Spain"
      }
    })),
    "worksFor": {
      "@type": "Organization",
      "name": jobs[0].company,
      "url": jobs[0].link
    }
  })} />

  <div class="container">

    <section class="section-about reveal">
      <h2>Background</h2>
      <div>
        <p>{t('sobre.desc1')}</p>
      </div>
    </section>

    <section class="section-about reveal">
      <h2>{t('sobre.skillsTitle')}</h2>
        <div class="skills-grid">
          {skillCategories.map(cat => (
            <div class="skill-column">
              <span class="skill-label">{cat.label}</span>
              <ul>{cat.items.map(item => <li>{item}</li>)}</ul>
            </div>
          ))}
        </div>
    </section>

    <section class="section-about reveal">
      <h2>{t('sobre.experienceTitle')}</h2>
        <div>
          {jobs.map(job => (
            <div class="job-item">
              <div class="job-header">
                {job.link ? (
                  <a href={job.link} target="_blank" class="job__company">{job.company}</a>
                ) : (
                  <span class="job__company">{job.company}</span>
                )}
                <span class="job__period">{job.period}</span>
              </div>
              <div>{job.position}</div>
            </div>
          ))}
        <a href="https://www.linkedin.com/in/jjmontalban/" class="cta cta-primary">{t('sobre.downloadCV')}</a>
        </div>

    </section>

    <ContactCTA
      title={t('sobre.cta.title')}
      button={t('sobre.cta.button')}
    />
  </div>
</Layout>
