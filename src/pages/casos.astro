---
import Layout from "../layouts/Layout.astro";
import ContactCTA from "../components/ContactCTA.astro";
import { getCollection } from "astro:content";
import { wordpress, php, mysql, javascript, woocommerce, mailchimp, googlecalendar } from "../lib/icons";

/* ========================================================= */
/* CONTENT                                                   */
/* ========================================================= */

const casos = (await getCollection("casos"))
  .sort((a,b)=>a.data.order-b.data.order);

const otrosCasos = (await getCollection("otros-casos"))
  .sort((a,b)=>a.data.order-b.data.order);
---

<Layout
  title="Casos de éxito | JJMontalban"
  page="page-casos"
  description="Casos reales de proyectos WordPress: integraciones avanzadas, plugins a medida y soluciones técnicas en producción."
>
  <div class="container">
    <section class="content-container">
      <h1>Proyectos de verdad</h1>

      <p class="lead">
        Casos reales de soluciones técnicas, desarrollos a medida e integraciones complejas.
      </p>

      <div class="cases-list">
        {casos.map(({ slug, data }, index) => (
          <article class={`case-item ${index % 2 !== 0 ? "reverse" : ""}`}>
            <div class="case-image">
              {data.image && (
                <img src={data.image} alt={data.title} loading="lazy" />
              )}
            </div>

            <div class="case-content">
              <h2>{data.title}</h2>

              {data.intro && (
                <p class="case-desc">{data.intro}</p>
              )}

              <div class="case-tech-row">
                <ul class="case-tech">

                  {slug === "chipicasa" && (
                    <>
                      <li class="case-tech-icon">
                        <svg {...wordpress.attributes} set:html={wordpress.body} />
                        <span class="sr-only">wordpress</span>
                      </li>
                      <li class="case-tech-icon">
                        <svg {...php.attributes} set:html={php.body} />
                        <span class="sr-only">php</span>
                      </li>
                      <li class="case-tech-icon">
                        <svg {...mysql.attributes} set:html={mysql.body} />
                        <span class="sr-only">mysql</span>
                      </li>
                    </>
                  )}

                  {slug === "brunimarsa" && (
                    <>
                      <li class="case-tech-icon">
                        <svg {...wordpress.attributes} set:html={wordpress.body} />
                        <span class="sr-only">wordpress</span>
                      </li>
                      <li class="case-tech-icon">
                        <svg {...php.attributes} set:html={php.body} />
                        <span class="sr-only">php</span>
                      </li>
                      <li class="case-tech-icon">
                        <svg {...mailchimp.attributes} set:html={mailchimp.body} />
                        <span class="sr-only">mailchimp api</span>
                      </li>
                    </>
                  )}

                  {slug === "caramelotattoo" && (
                    <>
                      <li class="case-tech-icon">
                        <svg {...wordpress.attributes} set:html={wordpress.body} />
                        <span class="sr-only">wordpress</span>
                      </li>
                      <li class="case-tech-icon">
                        <svg {...php.attributes} set:html={php.body} />
                        <span class="sr-only">php</span>
                      </li>
                      <li class="case-tech-icon">
                        <svg {...googlecalendar.attributes} set:html={googlecalendar.body} />
                        <span class="sr-only">google calendar api</span>
                      </li>
                    </>
                  )}

                  {slug === "eresagua" && (
                    <>
                      <li class="case-tech-icon">
                        <svg {...wordpress.attributes} set:html={wordpress.body} />
                        <span class="sr-only">wordpress</span>
                      </li>
                      <li class="case-tech-icon">
                        <svg {...woocommerce.attributes} set:html={woocommerce.body} />
                        <span class="sr-only">woocommerce</span>
                      </li>
                      <li class="case-tech-icon">
                        <svg {...javascript.attributes} set:html={javascript.body} />
                        <span class="sr-only">javascript</span>
                      </li>
                    </>
                  )}

                </ul>

                <a href={`/casos/${slug}`} class="cta">
                  Ver detalle
                </a>
              </div>
            </div>
          </article>
        ))}
      </div>
    </section>

    <section class="other-cases">
      <h2>Otros casos</h2>

      <div class="other-cases-grid">
        {otrosCasos.map(({ data }) => (
          <a
            href={data.link}
            target="_blank"
            rel="noopener noreferrer"
            class="other-case-card"
          >
            <div class="other-case-image">
              <img src={data.image} alt={data.title} loading="lazy" />
            </div>

            <div class="other-case-content">
              <h3>{data.title}</h3>
              <p>{data.excerpt}</p>
            </div>
          </a>
        ))}
      </div>
    </section>

    <ContactCTA
      title="¿Quieres resultados similares?"
      text="Estos proyectos partieron de una conversación."
    />
  </div>
</Layout>

