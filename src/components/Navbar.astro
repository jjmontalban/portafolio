---
import { x } from "../lib/icons";
import LanguageSwitch from "./LanguageSwitch.astro";
import { getLangFromUrl, useTranslations } from '../i18n/utils';

interface Props {
  current?: string;
}

const { current } = Astro.props;
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<nav class="navbar">
  <a href={`/${lang}`}>
    <img class="site-logo" src="/images/jj.png" alt="JJ" />
  </a>

  <button class="burger" aria-label={t('nav.openMenu')} aria-expanded="false" aria-controls="site-navigation" type="button">☰</button>

  <div id="site-navigation" class="nav-links" role="navigation">
    <button class="nav-close" aria-label={t('nav.closeMenu')} type="button">
      <svg class="nav-close-icon" viewBox="0 0 24 24" set:html={x.body} />
    </button>

    <!-- Language switch MÓVIL (solo en menú móvil) -->
    <div class="nav-lang-mobile">
      <LanguageSwitch />
    </div>

    <a href={`/${lang}`} class:list={{ selected: current === "home" }}>{t('nav.inicio')}</a>
    <a href={`/${lang}/servicios`} class:list={{ selected: current === "servicios" }}>{t('nav.servicios')}</a>
    <a href={`/${lang}/casos`} class:list={{ selected: current === "casos" }}>{t('nav.casos')}</a>
    <a href={`/${lang}/plugins`} class:list={{ selected: current === "plugins" }}>{t('nav.plugins')}</a>
    <a href={`/${lang}/contacto`} class:list={{ selected: current === "contacto" }}>{t('nav.contacto')}</a>

    <!-- Language switch DESKTOP (al final de los enlaces) -->
    <div class="nav-lang-desktop">
      <LanguageSwitch />
    </div>
  </div>
</nav>